// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
#pragma warning disable IDE0130 // Namespace does not match folder structure

namespace MenphisSI.GerAdv.Writers;
#pragma warning restore IDE0130 // Namespace does not match folder structure

public partial interface IOperadorWriter
{
    Task<FOperador> WriteAsync(Models.Operador operador, int auditorQuem, MsiSqlConnection oCnn);
    Task Delete(OperadorResponse operador, int operadorId, MsiSqlConnection oCnn);
}

public class OperadorWriter(IFOperadorFactory operadorFactory) : IOperadorWriter
{
    private readonly IFOperadorFactory _operadorFactory = operadorFactory ?? throw new ArgumentNullException(nameof(operadorFactory));
    public virtual async Task Delete(OperadorResponse operador, int operadorId, MsiSqlConnection oCnn)
    {
        await _operadorFactory.DeleteAsync(operadorId, operador.Id, oCnn);
    }

    public virtual async Task<FOperador> WriteAsync(Models.Operador operador, int auditorQuem, MsiSqlConnection oCnn)
    {
        using var dbRec = await (operador.Id.IsEmptyIDNumber() ? _operadorFactory.CreateAsync() : _operadorFactory.CreateFromIdAsync(operador.Id, oCnn));
        dbRec.FEMail = operador.EMail;
        dbRec.FPasta = operador.Pasta;
        dbRec.FTelefonista = operador.Telefonista;
        dbRec.FMaster = operador.Master;
        dbRec.FNome = operador.Nome;
        dbRec.FNick = operador.Nick;
        dbRec.FRamal = operador.Ramal;
        dbRec.FCadID = operador.CadID;
        dbRec.FCadCod = operador.CadCod;
        dbRec.FExcluido = operador.Excluido;
        dbRec.FSituacao = operador.Situacao;
        dbRec.FComputador = operador.Computador;
        dbRec.FMinhaDescricao = operador.MinhaDescricao;
        if (operador.UltimoLogoff != null)
            dbRec.FUltimoLogoff = operador.UltimoLogoff.ToString();
        dbRec.FEMailNet = operador.EMailNet;
        dbRec.FOnlineIP = operador.OnlineIP;
        dbRec.FOnLine = operador.OnLine;
        dbRec.FSysOp = operador.SysOp;
        dbRec.FStatusId = operador.StatusId;
        dbRec.FStatusMessage = operador.StatusMessage;
        dbRec.FIsFinanceiro = operador.IsFinanceiro;
        dbRec.FGUID = operador.GUID;
        dbRec.FTop = operador.Top;
        dbRec.FSexo = operador.Sexo;
        dbRec.FBasico = operador.Basico;
        dbRec.FExterno = operador.Externo;
        if (operador.Senha256.Length > 0)
            dbRec.FSenha256 = operador.Senha256.GetHashCode2();
        dbRec.FEMailConfirmado = operador.EMailConfirmado;
        if (operador.DataLimiteReset != null)
            dbRec.FDataLimiteReset = operador.DataLimiteReset.ToString();
        if (operador.SuporteSenha256.Length > 0)
            dbRec.FSuporteSenha256 = operador.SuporteSenha256.Encrypt();
        if (operador.SuporteMaxAge != null)
            dbRec.FSuporteMaxAge = operador.SuporteMaxAge.ToString();
        dbRec.FSuporteNomeSolicitante = operador.SuporteNomeSolicitante;
        if (operador.SuporteUltimoAcesso != null)
            dbRec.FSuporteUltimoAcesso = operador.SuporteUltimoAcesso.ToString();
        dbRec.FSuporteIpUltimoAcesso = operador.SuporteIpUltimoAcesso;
        dbRec.AuditorQuem = auditorQuem;
        await dbRec.UpdateAsync(oCnn);
        return dbRec;
    }
}