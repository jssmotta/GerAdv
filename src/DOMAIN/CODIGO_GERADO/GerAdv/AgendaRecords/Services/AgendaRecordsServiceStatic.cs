// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
#pragma warning disable IDE0130 // Namespace does not match folder structure

namespace MenphisSI.GerAdv.Services;
#pragma warning restore IDE0130 // Namespace does not match folder structure

public partial class AgendaRecordsService
{
    private static (string where, List<SqlParameter> parametros)? WFiltro(Filters.FilterAgendaRecords filtro)
    {
        var parameters = new List<SqlParameter>();
        if (filtro.Agenda != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Agenda)}", filtro.Agenda));
        }

        if (filtro.Julgador != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Julgador)}", filtro.Julgador));
        }

        if (filtro.Julgador_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Julgador)}_end", filtro.Julgador_end));
        }

        if (filtro.ClientesSocios != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.ClientesSocios)}", filtro.ClientesSocios));
        }

        if (filtro.Perito != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Perito)}", filtro.Perito));
        }

        if (filtro.Perito_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Perito)}_end", filtro.Perito_end));
        }

        if (filtro.Colaborador != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Colaborador)}", filtro.Colaborador));
        }

        if (filtro.Foro != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Foro)}", filtro.Foro));
        }

        if (filtro.Aviso1 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Aviso1)}", filtro.Aviso1));
        }

        if (filtro.Aviso2 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Aviso2)}", filtro.Aviso2));
        }

        if (filtro.Aviso3 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.Aviso3)}", filtro.Aviso3));
        }

        if (filtro.CrmAviso1 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}", filtro.CrmAviso1));
        }

        if (filtro.CrmAviso1_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}_end", filtro.CrmAviso1_end));
        }

        if (filtro.CrmAviso2 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}", filtro.CrmAviso2));
        }

        if (filtro.CrmAviso2_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}_end", filtro.CrmAviso2_end));
        }

        if (filtro.CrmAviso3 != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}", filtro.CrmAviso3));
        }

        if (filtro.CrmAviso3_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}_end", filtro.CrmAviso3_end));
        }

        if (!filtro.DataAviso1.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso1, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso1)}", dataParam));
        }

        if (!filtro.DataAviso1_end.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso1_end, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso1)}_end", dataParam));
        }

        if (!filtro.DataAviso2.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso2, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso2)}", dataParam));
        }

        if (!filtro.DataAviso2_end.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso2_end, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso2)}_end", dataParam));
        }

        if (!filtro.DataAviso3.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso3, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso3)}", dataParam));
        }

        if (!filtro.DataAviso3_end.IsEmpty())
        {
            if (DateTime.TryParse(filtro.DataAviso3_end, out var dataParam))
                parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.DataAviso3)}_end", dataParam));
        }

        if (filtro.Codigo_filtro != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}", filtro.Codigo_filtro));
        }

        if (filtro.Codigo_filtro_end != int.MinValue)
        {
            parameters.Add(new($"@{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}_end", filtro.Codigo_filtro_end));
        }

        if (filtro.LogicalOperator.IsEmpty() || (filtro.LogicalOperator.NotEquals(TSql.And) && filtro.LogicalOperator.NotEquals(TSql.OR)))
        {
            filtro.LogicalOperator = TSql.And;
        }

        var cWhere = new StringBuilder();
        cWhere.Append(filtro.Agenda <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Agenda}] = @{nameof(DBAgendaRecordsDicInfo.Agenda)}");
        if (!filtro.Julgador.IsEmpty() && filtro.Julgador_end.IsEmpty())
        {
            cWhere.Append(filtro.Julgador <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Julgador}] >= @{nameof(DBAgendaRecordsDicInfo.Julgador)}");
        }
        else
        {
            cWhere.Append((filtro.Julgador <= 0 && filtro.Julgador_end <= 0) ? string.Empty : (!(filtro.Julgador <= 0) && !(filtro.Julgador_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Julgador} BETWEEN @{nameof(DBAgendaRecordsDicInfo.Julgador)} AND @{nameof(DBAgendaRecordsDicInfo.Julgador)}_end" : !(filtro.Julgador <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Julgador} = @{nameof(DBAgendaRecordsDicInfo.Julgador)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Julgador} <= @{nameof(DBAgendaRecordsDicInfo.Julgador)}_end");
        }

        cWhere.Append(filtro.ClientesSocios <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.ClientesSocios}] = @{nameof(DBAgendaRecordsDicInfo.ClientesSocios)}");
        if (!filtro.Perito.IsEmpty() && filtro.Perito_end.IsEmpty())
        {
            cWhere.Append(filtro.Perito <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Perito}] >= @{nameof(DBAgendaRecordsDicInfo.Perito)}");
        }
        else
        {
            cWhere.Append((filtro.Perito <= 0 && filtro.Perito_end <= 0) ? string.Empty : (!(filtro.Perito <= 0) && !(filtro.Perito_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Perito} BETWEEN @{nameof(DBAgendaRecordsDicInfo.Perito)} AND @{nameof(DBAgendaRecordsDicInfo.Perito)}_end" : !(filtro.Perito <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Perito} = @{nameof(DBAgendaRecordsDicInfo.Perito)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.Perito} <= @{nameof(DBAgendaRecordsDicInfo.Perito)}_end");
        }

        cWhere.Append(filtro.Colaborador <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Colaborador}] = @{nameof(DBAgendaRecordsDicInfo.Colaborador)}");
        cWhere.Append(filtro.Foro <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Foro}] = @{nameof(DBAgendaRecordsDicInfo.Foro)}");
        cWhere.Append(filtro.Aviso1 == int.MinValue ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Aviso1}] = @{nameof(DBAgendaRecordsDicInfo.Aviso1)}");
        cWhere.Append(filtro.Aviso2 == int.MinValue ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Aviso2}] = @{nameof(DBAgendaRecordsDicInfo.Aviso2)}");
        cWhere.Append(filtro.Aviso3 == int.MinValue ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.Aviso3}] = @{nameof(DBAgendaRecordsDicInfo.Aviso3)}");
        if (!filtro.CrmAviso1.IsEmpty() && filtro.CrmAviso1_end.IsEmpty())
        {
            cWhere.Append(filtro.CrmAviso1 <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.CrmAviso1}] >= @{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}");
        }
        else
        {
            cWhere.Append((filtro.CrmAviso1 <= 0 && filtro.CrmAviso1_end <= 0) ? string.Empty : (!(filtro.CrmAviso1 <= 0) && !(filtro.CrmAviso1_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso1} BETWEEN @{nameof(DBAgendaRecordsDicInfo.CrmAviso1)} AND @{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}_end" : !(filtro.CrmAviso1 <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso1} = @{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso1} <= @{nameof(DBAgendaRecordsDicInfo.CrmAviso1)}_end");
        }

        if (!filtro.CrmAviso2.IsEmpty() && filtro.CrmAviso2_end.IsEmpty())
        {
            cWhere.Append(filtro.CrmAviso2 <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.CrmAviso2}] >= @{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}");
        }
        else
        {
            cWhere.Append((filtro.CrmAviso2 <= 0 && filtro.CrmAviso2_end <= 0) ? string.Empty : (!(filtro.CrmAviso2 <= 0) && !(filtro.CrmAviso2_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso2} BETWEEN @{nameof(DBAgendaRecordsDicInfo.CrmAviso2)} AND @{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}_end" : !(filtro.CrmAviso2 <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso2} = @{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso2} <= @{nameof(DBAgendaRecordsDicInfo.CrmAviso2)}_end");
        }

        if (!filtro.CrmAviso3.IsEmpty() && filtro.CrmAviso3_end.IsEmpty())
        {
            cWhere.Append(filtro.CrmAviso3 <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.CrmAviso3}] >= @{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}");
        }
        else
        {
            cWhere.Append((filtro.CrmAviso3 <= 0 && filtro.CrmAviso3_end <= 0) ? string.Empty : (!(filtro.CrmAviso3 <= 0) && !(filtro.CrmAviso3_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso3} BETWEEN @{nameof(DBAgendaRecordsDicInfo.CrmAviso3)} AND @{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}_end" : !(filtro.CrmAviso3 <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso3} = @{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CrmAviso3} <= @{nameof(DBAgendaRecordsDicInfo.CrmAviso3)}_end");
        }

        if (!filtro.DataAviso1.IsEmpty() && filtro.DataAviso1_end.IsEmpty())
        {
            cWhere.Append(filtro.DataAviso1.IsEmpty() ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"CONVERT(DATE,[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.DataAviso1}], 103) >= CONVERT(DATE, @{nameof(DBAgendaRecordsDicInfo.DataAviso1)}, 103)");
        }
        else
        {
            cWhere.Append((filtro.DataAviso1.IsEmpty() && filtro.DataAviso1_end.IsEmpty()) ? string.Empty : (!(filtro.DataAviso1.IsEmpty()) && !(filtro.DataAviso1_end.IsEmpty())) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso1} BETWEEN @{nameof(DBAgendaRecordsDicInfo.DataAviso1)} AND @{nameof(DBAgendaRecordsDicInfo.DataAviso1)}_end" : !(filtro.DataAviso1.IsEmpty()) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso1} = @{nameof(DBAgendaRecordsDicInfo.DataAviso1)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso1} <= @{nameof(DBAgendaRecordsDicInfo.DataAviso1)}_end");
        }

        if (!filtro.DataAviso2.IsEmpty() && filtro.DataAviso2_end.IsEmpty())
        {
            cWhere.Append(filtro.DataAviso2.IsEmpty() ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"CONVERT(DATE,[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.DataAviso2}], 103) >= CONVERT(DATE, @{nameof(DBAgendaRecordsDicInfo.DataAviso2)}, 103)");
        }
        else
        {
            cWhere.Append((filtro.DataAviso2.IsEmpty() && filtro.DataAviso2_end.IsEmpty()) ? string.Empty : (!(filtro.DataAviso2.IsEmpty()) && !(filtro.DataAviso2_end.IsEmpty())) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso2} BETWEEN @{nameof(DBAgendaRecordsDicInfo.DataAviso2)} AND @{nameof(DBAgendaRecordsDicInfo.DataAviso2)}_end" : !(filtro.DataAviso2.IsEmpty()) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso2} = @{nameof(DBAgendaRecordsDicInfo.DataAviso2)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso2} <= @{nameof(DBAgendaRecordsDicInfo.DataAviso2)}_end");
        }

        if (!filtro.DataAviso3.IsEmpty() && filtro.DataAviso3_end.IsEmpty())
        {
            cWhere.Append(filtro.DataAviso3.IsEmpty() ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"CONVERT(DATE,[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.DataAviso3}], 103) >= CONVERT(DATE, @{nameof(DBAgendaRecordsDicInfo.DataAviso3)}, 103)");
        }
        else
        {
            cWhere.Append((filtro.DataAviso3.IsEmpty() && filtro.DataAviso3_end.IsEmpty()) ? string.Empty : (!(filtro.DataAviso3.IsEmpty()) && !(filtro.DataAviso3_end.IsEmpty())) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso3} BETWEEN @{nameof(DBAgendaRecordsDicInfo.DataAviso3)} AND @{nameof(DBAgendaRecordsDicInfo.DataAviso3)}_end" : !(filtro.DataAviso3.IsEmpty()) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso3} = @{nameof(DBAgendaRecordsDicInfo.DataAviso3)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.DataAviso3} <= @{nameof(DBAgendaRecordsDicInfo.DataAviso3)}_end");
        }

        if (!filtro.Codigo_filtro.IsEmpty() && filtro.Codigo_filtro_end.IsEmpty())
        {
            cWhere.Append(filtro.Codigo_filtro <= 0 ? string.Empty : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"[{DBAgendaRecordsDicInfo.PTabelaNome}].[{DBAgendaRecordsDicInfo.CampoCodigo}] >= @{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}");
        }
        else
        {
            cWhere.Append((filtro.Codigo_filtro <= 0 && filtro.Codigo_filtro_end <= 0) ? string.Empty : (!(filtro.Codigo_filtro <= 0) && !(filtro.Codigo_filtro_end <= 0)) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CampoCodigo} BETWEEN @{nameof(DBAgendaRecordsDicInfo.CampoCodigo)} AND @{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}_end" : !(filtro.Codigo_filtro <= 0) ? (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CampoCodigo} = @{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}" : (cWhere.Length == 0 ? string.Empty : filtro.LogicalOperator) + $"{DBAgendaRecordsDicInfo.CampoCodigo} <= @{nameof(DBAgendaRecordsDicInfo.CampoCodigo)}_end");
        }

        return (cWhere.ToString().Trim(), parameters);
    }

    private static string ApplyWildCard(char wildcardChar, string value)
    {
        if (wildcardChar == '\0' || wildcardChar == ' ')
        {
            return value;
        }

        var result = $"{wildcardChar}{value.Replace(" ", wildcardChar.ToString())}{wildcardChar}";
        return result;
    }

    private async Task<IEnumerable<AgendaRecordsResponseAll>> GetDataAllAsync(int max, string where, List<SqlParameter> parameters, string uri, CancellationToken token)
    {
        using var oCnn = Configuracoes.GetConnectionByUri(uri);
        if (oCnn == null)
        {
            throw new DatabaseConnectionException();
        }

        var result = await reader.Listar(max, uri, where, parameters, string.Empty, token);
        return result;
    }
}