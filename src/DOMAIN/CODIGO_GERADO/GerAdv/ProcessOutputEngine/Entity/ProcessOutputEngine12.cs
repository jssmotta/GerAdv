// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
namespace MenphisSI.GerAdv.Factory;
public partial class FProcessOutputEngine : MenphisSI.SG.GerAdv.DBProcessOutputEngine, IDBProcessOutputEngine
{
    // DI-compatible default constructor
    public FProcessOutputEngine() : base()
    {
    }

    // Factory method for creating instances with SqlDataReader
    public static FProcessOutputEngine CreateFromReader(SqlDataReader? dbRec)
    {
        return new FProcessOutputEngine(dbRec);
    }

    // Factory method for creating instances with DataRow
    public static FProcessOutputEngine CreateFromDataRow(DataRow? dbRec)
    {
        return new FProcessOutputEngine(dbRec);
    }

    private FProcessOutputEngine(SqlDataReader? dbRec) : base(dbRec)
    {
    }

    private FProcessOutputEngine(DataRow? dbRec) : base(dbRec)
    {
    }

    public async Task<FProcessOutputEngine> CreateFromIdAsync(int id, MsiSqlConnection? oCnn)
    {
        var fProcessOutputEngine = new FProcessOutputEngine();
        await fProcessOutputEngine.CarregarAsync(id, oCnn);
        return fProcessOutputEngine;
    }

    private FProcessOutputEngine(List<SqlParameter>? parameters, in string? cNome = "", MsiSqlConnection? oCnn = null, string? fullSql = "", string sqlWhere = "", in string join = "") : base(parameters, cNome, oCnn, fullSql, sqlWhere, join)
    {
    }

    // Factory method for creating instances with parameters
    public static FProcessOutputEngine CreateFromParameters(List<SqlParameter>? parameters, MsiSqlConnection? oCnn, in string? cNome = "", string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        return new FProcessOutputEngine(parameters, cNome, oCnn, fullSql, sqlWhere, join);
    }

    // Initialize method to load data with parameters after DI construction
    public void Initialize(List<SqlParameter>? parameters, MsiSqlConnection? oCnn, in string? cNome = "", string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        if (oCnn is null)
            return;
        if (string.IsNullOrEmpty(fullSql) && !string.IsNullOrEmpty(cNome))
        {
            if (cNome is null)
                return;
            sqlWhere = cNome;
        }

        if (!string.IsNullOrEmpty(sqlWhere) || !string.IsNullOrEmpty(fullSql))
        {
            using var ds = ConfiguracoesDBT.GetDataTable(parameters, string.IsNullOrEmpty(fullSql) ? $"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} {join} WHERE {sqlWhere};" : fullSql, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
        else
        {
            using var cmd = new SqlCommand($"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} WHERE [{CampoNome}] COLLATE SQL_Latin1_General_CP1_CI_AI like @CampoNome", oCnn?.InnerConnection);
            cmd.Parameters.AddWithValue("@CampoNome", cNome?.Trim() ?? string.Empty);
            using var ds = ConfiguracoesDBT.GetDataTable(cmd, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
    }
}