// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
namespace MenphisSI.GerAdv.Factory;
public partial class FAndComp : MenphisSI.SG.GerAdv.DBAndComp, IDBAndComp
{
    // DI-compatible default constructor
    public FAndComp() : base()
    {
    }

    // Factory method for creating instances with SqlDataReader
    public static FAndComp CreateFromReader(SqlDataReader? dbRec)
    {
        return new FAndComp(dbRec);
    }

    // Factory method for creating instances with DataRow
    public static FAndComp CreateFromDataRow(DataRow? dbRec)
    {
        return new FAndComp(dbRec);
    }

    private FAndComp(SqlDataReader? dbRec) : base(dbRec)
    {
    }

    private FAndComp(DataRow? dbRec) : base(dbRec)
    {
    }

    public async Task<FAndComp> CreateFromIdAsync(int id, MsiSqlConnection oCnn)
    {
        var fAndComp = new FAndComp();
        await fAndComp.CarregarAsync(id, oCnn);
        return fAndComp;
    }

    private FAndComp(List<SqlParameter> parameters, MsiSqlConnection? oCnn = null, string? fullSql = "", string sqlWhere = "", in string join = "") : base(parameters, oCnn, fullSql, sqlWhere, join)
    {
    }

    // Factory method for creating instances with parameters
    public static FAndComp CreateFromParameters(List<SqlParameter> parameters, MsiSqlConnection oCnn, string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        return new FAndComp(parameters, oCnn, fullSql, sqlWhere, join);
    }

    // Initialize method to load data with parameters after DI construction
    public void Initialize(List<SqlParameter> parameters, MsiSqlConnection oCnn, string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        if (oCnn is null)
            return;
        if (!string.IsNullOrEmpty(sqlWhere) || !string.IsNullOrEmpty(fullSql))
        {
            using var ds = ConfiguracoesDBT.GetDataTable(parameters, string.IsNullOrEmpty(fullSql) ? $"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} {join} WHERE {sqlWhere};" : fullSql, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
        else
        {
            using var cmd = new SqlCommand($"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} WHERE [{CampoNome}] COLLATE SQL_Latin1_General_CP1_CI_AI like @CampoNome", oCnn?.InnerConnection);
            using var ds = ConfiguracoesDBT.GetDataTable(cmd, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
    }
}