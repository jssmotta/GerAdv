// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
namespace MenphisSI.GerAdv.Factory;
public partial class FNECompromissos : MenphisSI.SG.GerAdv.DBNECompromissos, IDBNECompromissos
{
    // DI-compatible default constructor
    public FNECompromissos() : base()
    {
    }

    // Factory method for creating instances with SqlDataReader
    public static FNECompromissos CreateFromReader(SqlDataReader? dbRec)
    {
        return new FNECompromissos(dbRec);
    }

    // Factory method for creating instances with DataRow
    public static FNECompromissos CreateFromDataRow(DataRow? dbRec)
    {
        return new FNECompromissos(dbRec);
    }

    private FNECompromissos(SqlDataReader? dbRec) : base(dbRec)
    {
    }

    private FNECompromissos(DataRow? dbRec) : base(dbRec)
    {
    }

    public async Task<FNECompromissos> CreateFromIdAsync(int id, MsiSqlConnection? oCnn)
    {
        var fNECompromissos = new FNECompromissos();
        await fNECompromissos.CarregarAsync(id, oCnn);
        return fNECompromissos;
    }

    private FNECompromissos(List<SqlParameter>? parameters, MsiSqlConnection? oCnn = null, string? fullSql = "", string sqlWhere = "", in string join = "") : base(parameters, oCnn, fullSql, sqlWhere, join)
    {
    }

    // Factory method for creating instances with parameters
    public static FNECompromissos CreateFromParameters(List<SqlParameter>? parameters, MsiSqlConnection? oCnn, string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        return new FNECompromissos(parameters, oCnn, fullSql, sqlWhere, join);
    }

    // Initialize method to load data with parameters after DI construction
    public void Initialize(List<SqlParameter>? parameters, MsiSqlConnection? oCnn, string? fullSql = "", string sqlWhere = "", in string join = "")
    {
        if (oCnn is null)
            return;
        if (!string.IsNullOrEmpty(sqlWhere) || !string.IsNullOrEmpty(fullSql))
        {
            using var ds = ConfiguracoesDBT.GetDataTable(parameters, string.IsNullOrEmpty(fullSql) ? $"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} {join} WHERE {sqlWhere};" : fullSql, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
        else
        {
            using var cmd = new SqlCommand($"SET NOCOUNT ON; SELECT TOP (1) {CamposSqlX} FROM {PTabelaNome.dbo(oCnn)} WHERE [{CampoNome}] COLLATE SQL_Latin1_General_CP1_CI_AI like @CampoNome", oCnn?.InnerConnection);
            using var ds = ConfiguracoesDBT.GetDataTable(cmd, CommandBehavior.SingleRow, oCnn);
            if (ds != null)
                CarregarDadosBd(ds.Rows.Count == 0 ? null : ds.Rows[0]);
        }
    }
}