// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
#pragma warning disable IDE0130 // Namespace does not match folder structure

namespace MenphisSI.GerAdv.Writers;
#pragma warning restore IDE0130 // Namespace does not match folder structure

public partial interface IEscritoriosWriter
{
    Task<FEscritorios> WriteAsync(Models.Escritorios escritorios, int auditorQuem, MsiSqlConnection oCnn);
    Task Delete(EscritoriosResponse escritorios, int operadorId, MsiSqlConnection oCnn);
}

public class EscritoriosWriter(IFEscritoriosFactory escritoriosFactory) : IEscritoriosWriter
{
    private readonly IFEscritoriosFactory _escritoriosFactory = escritoriosFactory;
    public async Task Delete(EscritoriosResponse escritorios, int operadorId, MsiSqlConnection oCnn)
    {
        await _escritoriosFactory.DeleteAsync(operadorId, escritorios.Id, oCnn);
    }

    public async Task<FEscritorios> WriteAsync(Models.Escritorios escritorios, int auditorQuem, MsiSqlConnection oCnn)
    {
        using var dbRec = await (escritorios.Id.IsEmptyIDNumber() ? _escritoriosFactory.CreateAsync() : _escritoriosFactory.CreateFromIdAsync(escritorios.Id, oCnn));
        dbRec.FCNPJ = escritorios.CNPJ.ClearInputCnpj();
        dbRec.FCasa = escritorios.Casa;
        dbRec.FParceria = escritorios.Parceria;
        dbRec.FNome = escritorios.Nome;
        dbRec.FOAB = escritorios.OAB;
        dbRec.FEndereco = escritorios.Endereco;
        dbRec.FCidade = escritorios.Cidade;
        dbRec.FBairro = escritorios.Bairro;
        dbRec.FCEP = escritorios.CEP.ClearInputCep();
        dbRec.FFone = escritorios.Fone;
        dbRec.FFax = escritorios.Fax;
        dbRec.FSite = escritorios.Site;
        dbRec.FEMail = escritorios.EMail;
        dbRec.FOBS = escritorios.OBS;
        dbRec.FAdvResponsavel = escritorios.AdvResponsavel;
        dbRec.FSecretaria = escritorios.Secretaria;
        dbRec.FInscEst = escritorios.InscEst;
        dbRec.FCorrespondente = escritorios.Correspondente;
        dbRec.FTop = escritorios.Top;
        dbRec.FGUID = escritorios.GUID;
        dbRec.AuditorQuem = auditorQuem;
        await dbRec.UpdateAsync(oCnn);
        return dbRec;
    }
}