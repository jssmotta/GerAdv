// 100% auto-generated by Source Genesys WebApi Front & Back Creator
// copyright © 2000-2025 Menphis - Sistemas Inteligentes
// This file is part of the Source Genesys project                     
#pragma warning disable IDE0130 // Namespace does not match folder structure

namespace MenphisSI.GerAdv.Writers;
#pragma warning restore IDE0130 // Namespace does not match folder structure

public partial interface IOperadoresWriter
{
    Task<FOperadores> WriteAsync(Models.Operadores operadores, int auditorQuem, MsiSqlConnection? oCnn);
    Task Delete(OperadoresResponse operadores, int operadorId, MsiSqlConnection? oCnn);
}

public class OperadoresWriter(IFOperadoresFactory operadoresFactory) : IOperadoresWriter
{
    private readonly IFOperadoresFactory _operadoresFactory = operadoresFactory ?? throw new ArgumentNullException(nameof(operadoresFactory));
    public virtual async Task Delete(OperadoresResponse operadores, int operadorId, MsiSqlConnection? oCnn)
    {
        await _operadoresFactory.DeleteAsync(operadorId, operadores.Id, oCnn);
    }

    public virtual async Task<FOperadores> WriteAsync(Models.Operadores operadores, int auditorQuem, MsiSqlConnection? oCnn)
    {
        using var dbRec = await (operadores.Id.IsEmptyIDNumber() ? _operadoresFactory.CreateAsync() : _operadoresFactory.CreateFromIdAsync(operadores.Id, oCnn));
        dbRec.FEnviado = operadores.Enviado;
        dbRec.FCasa = operadores.Casa;
        dbRec.FCasaID = operadores.CasaID;
        dbRec.FCasaCodigo = operadores.CasaCodigo;
        dbRec.FIsNovo = operadores.IsNovo;
        dbRec.FCliente = operadores.Cliente;
        dbRec.FGrupo = operadores.Grupo;
        dbRec.FNome = operadores.Nome;
        dbRec.FEMail = operadores.EMail;
        if (operadores.Senha.Length > 0)
            dbRec.FSenha = operadores.Senha.Encrypt();
        dbRec.FAtivado = operadores.Ativado;
        dbRec.FAtualizarSenha = operadores.AtualizarSenha;
        if (operadores.Senha256.Length > 0)
            dbRec.FSenha256 = operadores.Senha256.Encrypt();
        if (operadores.SuporteSenha256.Length > 0)
            dbRec.FSuporteSenha256 = operadores.SuporteSenha256.Encrypt();
        if (operadores.SuporteMaxAge != null)
            dbRec.FSuporteMaxAge = operadores.SuporteMaxAge.ToString();
        dbRec.AuditorQuem = auditorQuem;
        await dbRec.UpdateAsync(oCnn);
        return dbRec;
    }
}